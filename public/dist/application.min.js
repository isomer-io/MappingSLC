"use strict";var ApplicationConfiguration=function(){var applicationModuleName="mean",applicationModuleVendorDependencies=["ngResource","ngAnimate","ngTouch","ngSanitize","ngMessages","ui.router","ui.bootstrap","ui.utils","ngCkeditor","bootstrapLightbox","angularFileUpload","cgNotify","angular-loading-bar","videosharing-embed"],registerModule=function(moduleName,dependencies){angular.module(moduleName,dependencies||[]),angular.module(applicationModuleName).requires.push(moduleName)};return{applicationModuleName:applicationModuleName,applicationModuleVendorDependencies:applicationModuleVendorDependencies,registerModule:registerModule}}();
"use strict";angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider","$httpProvider",function($locationProvider,$httpProvider){$locationProvider.html5Mode(!0).hashPrefix("!"),$httpProvider.interceptors.push("authInterceptor")}]),angular.module(ApplicationConfiguration.applicationModuleName).run(["$rootScope","$state","Authentication",function($rootScope,$state,Authentication){$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){if(toState.data&&toState.data.roles&&toState.data.roles.length>0){var allowed=!1;toState.data.roles.forEach(function(role){return void 0!==Authentication.user.roles&&-1!==Authentication.user.roles.indexOf(role)?(allowed=!0,!0):void 0}),allowed||(event.preventDefault(),void 0!==Authentication.user&&"object"==typeof Authentication.user?$state.go("forbidden"):$state.go("authentication.signin"))}}),$rootScope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){fromState.data&&fromState.data.ignoreState||($state.previous={state:fromState,params:fromParams,href:$state.href(fromState,fromParams)})})}]),angular.element(document).ready(function(){if(window.location.hash&&"#_=_"===window.location.hash)if(window.history&&history.pushState)window.history.pushState("",document.title,window.location.pathname);else{var scroll={top:document.body.scrollTop,left:document.body.scrollLeft};window.location.hash="",document.body.scrollTop=scroll.top,document.body.scrollLeft=scroll.left}angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])});
"use strict";ApplicationConfiguration.registerModule("admins");
"use strict";ApplicationConfiguration.registerModule("chat");
"use strict";ApplicationConfiguration.registerModule("contacts");
"use strict";ApplicationConfiguration.registerModule("core"),ApplicationConfiguration.registerModule("core.admin",["core"]),ApplicationConfiguration.registerModule("core.admin.routes",["ui.router"]);
"use strict";ApplicationConfiguration.registerModule("projects");
"use strict";ApplicationConfiguration.registerModule("users",["core"]),ApplicationConfiguration.registerModule("users.admin",["core.admin"]),ApplicationConfiguration.registerModule("users.admin.routes",["core.admin.routes"]);
"use strict";angular.module("admins").config(["$stateProvider",function($stateProvider){$stateProvider.state("admin",{url:"/admin",templateUrl:"modules/admins/client/views/admins.client.view.html"}).state("adminProjectsQueue",{url:"/admin/projects-queue",templateUrl:"modules/admins/client/views/projects/admin-projects-list.client.view.html"}).state("adminEditProject",{url:"/admin/edit-project/:projectId",templateUrl:"modules/admins/client/views/projects/admin-view-project.client.view.html"}).state("adminListMessages",{url:"/admin/messages",templateUrl:"modules/admins/client/views/messages/admin-list-messages.client.view.html"}).state("adminViewMessage",{url:"/admin/messages/:contactId",templateUrl:"modules/admins/client/views/messages/admin-view-message.client.view.html"}).state("adminListUsers",{url:"/admin/list-users",templateUrl:"modules/admins/client/views/users/admin-list-users.client.view.html"}).state("adminViewUser",{url:"/users/:userId",templateUrl:"modules/admins/client/views/users/admin-view-user.client.view.html"}).state("adminEditUser",{url:"/users/:userId/edit",templateUrl:"modules/admins/client/views/users/admin-edit-user.client.view.html"}).state("createUser",{url:"/admin/create-user",templateUrl:"modules/users/client/views/create-user.client.view.html"}).state("adminDashboard",{url:"/admin/dashboard",templateUrl:"modules/admins/client/views/dashboard/admin-dashboard.client.view.html"})}]);
"use strict";angular.module("admins").controller("AdminsController",["$scope","d3","$stateParams","$location","Authentication","Projects","UserData","Contacts","AdminAuthService",function($scope,d3,$stateParams,$location,Authentication,Projects,UserData,Contacts,AdminAuthService){$scope.authentication=Authentication,$scope.isAdmin=AdminAuthService,$scope.colors=[{name:"Red",hex:"#F21B1B"},{name:"Blue",hex:"#1B66F2"},{name:"Green",hex:"#07BA16"}],$scope.color="",$scope.colorsArray=["Red","Green","Blue"];$scope.admin||$location.path("/"),$scope.remove=function(project){if(project){project.$remove();for(var i in $scope.projects)$scope.projects[i]===project&&$scope.projects.splice(i,1)}else $scope.project.$remove(function(){$location.path("projects")})},$scope.update=function(){var project=$scope.project;project.$update(function(){$location.path("projects/"+project._id)},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.findProjects=function(){$scope.projects=Projects.query()},$scope.findOneProject=function(){$scope.project=Projects.get({projectId:$stateParams.projectId})},$scope.updateUserProfile=function(){$scope.success=$scope.error=null;var user=new UserData($scope.user);user.$update(function(response){$scope.success=!0,Authentication.user=response},function(response){$scope.error=response.data.message})},$scope.hasConnectedAdditionalSocialAccounts=function(provider){for(var i in $scope.user.additionalProvidersData)return!0;return!1},$scope.isConnectedSocialAccount=function(provider){return $scope.user.provider===provider||$scope.user.additionalProvidersData&&$scope.user.additionalProvidersData[provider]}}]);

"use strict";angular.module("admins").directive("projectAdminFeatures",function(){return{restrict:"E",templateUrl:"/modules/admins/client/directives/views/project-admin-features.html"}});
"use strict";angular.module("admins").directive("projectEditor",function(){return{restrict:"E",templateUrl:"/modules/admins/client/directives/views/project-editor.html"}});
"use strict";angular.module("admins").directive("projectMainTab",function(){return{restrict:"E",templateUrl:"/modules/admins/client/directives/views/project-main-tab.html"}});
"use strict";angular.module("admins").directive("projectMultimedia",function(){return{restrict:"E",templateUrl:"/modules/admins/client/directives/views/project-multimedia.html"}});
"use strict";angular.module("admins").directive("projectViewForm",function(){return{restrict:"E",templateUrl:"/modules/admins/client/directives/views/project-view-form.html"}});
"use strict";angular.module("admins").directive("userViewForm",function(){return{restrict:"E",templateUrl:"/modules/admins/client/directives/views/user-view-form.html"}});
"use strict";angular.module("admins").factory("Admins",["$resource",function($resource){return $resource("api/v1/admins/:adminId",{adminId:"@_id"},{update:{method:"PUT"}})}]);
"use strict";angular.module("chat").run(["Menus",function(Menus){Menus.addMenuItem("topbar",{title:"Chat",state:"chat"})}]);
"use strict";angular.module("chat").config(["$stateProvider",function($stateProvider){$stateProvider.state("chat",{url:"/chat",templateUrl:"modules/chat/client/views/chat.client.view.html",data:{roles:["user","admin"]}})}]);
"use strict";angular.module("chat").controller("ChatController",["$scope","$location","Authentication","Socket",function($scope,$location,Authentication,Socket){$scope.messages=[],Authentication.user||$location.path("/"),Socket.socket||Socket.connect(),Socket.on("chatMessage",function(message){$scope.messages.unshift(message)}),$scope.sendMessage=function(){var message={text:this.messageText};Socket.emit("chatMessage",message),this.messageText=""},$scope.$on("$destroy",function(){Socket.removeListener("chatMessage")})}]);
"use strict";angular.module("contacts").config(["$stateProvider",function($stateProvider){$stateProvider.state("createContact",{url:"/contact-us",templateUrl:"modules/contacts/client/views/contact-us.client.view.html"}).state("editContact",{url:"/contacts/:contactId/edit",templateUrl:"modules/contacts/client/views/edit-contact.client.view.html"}).state("aboutMappingSlc",{url:"/about-the-project",templateUrl:"modules/contacts/client/views/about-mapping-slc.client.view.html"}).state("aboutUs",{url:"/about-us",templateUrl:"modules/contacts/client/views/about-us.client.view.html"})}]);
"use strict";angular.module("contacts").controller("ContactsController",["$scope","$stateParams","$location","Authentication","Contacts","$http","AdminAuthService","UtilsService","notify",function($scope,$stateParams,$location,Authentication,Contacts,$http,AdminAuthService,UtilsService,notify){$scope.authentication=Authentication,$scope.isAdmin=AdminAuthService,$scope.viewMessage=function(contactId){$location.path("admin/messages/"+contactId)},UtilsService.cssLayout(),$scope.toggleSort=!0,$scope.oneAtATime=!0,$scope.create=function(){var contact=new Contacts({firstName:this.firstName,lastName:this.lastName,email:this.email,zip:this.zip,newsletter:this.newsletter,message:this.message});contact.$save(function(response){$location.path("/"),$scope.firstName="",$scope.lastName="",$scope.email="",$scope.zip="",$scope.newsletter="",$scope.message="",console.log("response:\n",response),notify(response.$resolved?{message:"Thanks for the message!",classes:"ng-notify-contact-success"}:{message:"Something went wrong, and we didn't receive your message We apologize.",classes:"ng-notify-contact-failure"})},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.remove=function(contact){if(contact){contact.$remove();for(var i in $scope.contacts)$scope.contacts[i]===contact&&$scope.contacts.splice(i,1)}else $scope.contact.$remove(function(){$location.path("contacts")})},$scope.update=function(){var contact=$scope.contact;contact.$update(function(){$location.path("contacts/"+contact._id)},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.find=function(){$scope.contacts=Contacts.query()},$scope.findOne=function(){$scope.contact=Contacts.get({contactId:$stateParams.contactId})},$http.get("/contacts").success(function(messageData){$scope.messageData=messageData,$scope.sentToday=function(){var today=moment().calendar(messageData.created);return today}}).error(function(data,status){})}]);
"use strict";angular.module("contacts").factory("Contacts",["$resource",function($resource){return $resource("api/v1/contacts/:contactId",{contactId:"@_id"},{update:{method:"PUT"}})}]);
"use strict";angular.module("core.admin").run(["Menus",function(Menus){Menus.addMenuItem("topbar",{title:"Admin",state:"admin",type:"dropdown",roles:["admin"]})}]);

"use strict";angular.module("core").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise(function($injector,$location){$injector.get("$state").transitionTo("not-found",null,{location:!1})}),$stateProvider.state("home",{url:"/",templateUrl:"modules/core/client/views/home.client.view.html"}).state("not-found",{url:"/not-found",templateUrl:"modules/core/client/views/404.client.view.html",data:{ignoreState:!0}}).state("bad-request",{url:"/bad-request",templateUrl:"modules/core/client/views/400.client.view.html",data:{ignoreState:!0}}).state("forbidden",{url:"/forbidden",templateUrl:"modules/core/client/views/403.client.view.html",data:{ignoreState:!0}}).state("subscribeForm",{url:"/subscribe-form",templateUrl:"modules/core/views/subscribe-form.client.view.html"}).state("uploads",{url:"/uploads",templateUrl:"modules/core/views/file-upload.client.view.html"}).state("uploadFile",{url:"/uploads/:fileHash"})}]);
"use strict";angular.module("core").controller("RandomMapController",["$scope","$stateParams","$location","RandomMapService",function($scope,$stateParams,$location,RandomMapService){$scope.staticMap=RandomMapService.getRandomMap(),$scope.myFunction=function(){console.log("error loading that map!")}}]);
"use strict";angular.module("core").controller("HomeController",["$scope","Authentication","ApiKeys","$http","MarkerDataService","mapService","AdminAuthService","$rootScope","$location","$sce","UtilsService",function($scope,Authentication,ApiKeys,$http,MarkerDataService,mapService,AdminAuthService,$rootScope,$location,$sce,UtilsService){$scope.authentication=Authentication,$scope.isAdmin=AdminAuthService,$scope.featuredProjects={},UtilsService.cssLayout(),$scope.trustAsHtml=$sce.trustAsHtml,$scope.goToProject=function(id){$location.path("projects/"+id)},$scope.photo0="chris--bw-2.jpg",$scope.photo1="as_thumb_150.jpg",$scope.photo2="wli_thumb_150.jpg",$scope.photo3="dw_thumb_150.jpg",$scope.photo4="as_thumb_bw.png",$scope.projectMarker=null,$scope.markerData=null;$scope.overlayActive=!0,$scope.menuOpen=!1;var changeMapFrom=null;$scope.toggleOverlayFunction=function(source){$scope.overlayActive&&"overlay"===source?($scope.overlayActive=!$scope.overlayActive,changeMapFrom("gray-map")):$scope.overlayActive&&"menu-closed"===source?($scope.overlayActive=!1,$scope.menuOpen=!0,changeMapFrom("gray-map")):$scope.overlayActive||"menu-closed"!==source||$scope.menuOpen?$scope.overlayActive||"home"!==source||($scope.menuOpen=!1,$scope.overlayActive=!0):$scope.menuOpen=!$scope.menuOpen},$scope.attributionFull=!1,$scope.attributionText='<div style="padding: 0 5px 0 2px"><a href="http://www.mapbox.com/about/maps/" target="_blank">Mapbox</a> & <a href="http://leafletjs.com/" target="_blank">Leaflet</a>, with map data by <a href="http://openstreetmap.org/copyright">OpenStreetMapÂ©</a> | <a href="http://mapbox.com/map-feedback/" class="mapbox-improve-map">Improve this map</a></div>',$scope.markers=!0,$scope.filters=!0,$scope.censusDataTractLayer=!0,$scope.googlePlacesLayer=!1,$scope.sidebarToggle=!1,ApiKeys.getApiKeys().success(function(data){mapFunction(data.mapboxKey,data.mapboxSecret)}).error(function(data,status){alert("Failed to load Mapbox API key. Status: "+status)});var popupIndex=0,mapFunction=function(key,accessToken){L.mapbox.accessToken=accessToken;var map=(document.getElementById("info"),L.mapbox.map("map",null,{infoControl:!1,attributionControl:!1}).setView([40.7630772,-111.8689467],12).addControl(L.mapbox.shareControl()).addControl(L.mapbox.geocoderControl("mapbox.places"))),grayMap=L.mapbox.tileLayer("poetsrock.b06189bb"),mainMap=L.mapbox.tileLayer("poetsrock.la999il2"),topoMap=L.mapbox.tileLayer("poetsrock.la97f747"),greenMap=L.mapbox.tileLayer("poetsrock.jdgpalp2"),landscape=L.tileLayer("http://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png"),comic=L.mapbox.tileLayer("poetsrock.23d30eb5"),watercolor=L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"),layers={"Main Map":mainMap,"Topo Map":topoMap,"Green Map":greenMap,Landscape:landscape,"Comically Yours":comic,"Gray Day":grayMap,Watercolor:watercolor};grayMap.addTo(map),L.control.layers(layers).addTo(map),changeMapFrom=function(currentMap){"gray-map"===currentMap?(map.addLayer(mainMap),map.removeLayer(grayMap)):(map.addLayer(grayMap),map.removeLayer(mainMap))},MarkerDataService.getMarkerData().success(function(markerData){$scope.addProjectMarkers(markerData)}).error(function(data,status){alert("Failed to load project markers. Status: "+status)}),$scope.markerArray=[],$scope.addProjectMarkers=function(markerData){$scope.markerData=markerData;var index=0;for(var prop in markerData)$scope.projectMarker=L.mapbox.featureLayer({type:"Feature",geometry:{type:"Point",coordinates:[markerData[prop].lng,markerData[prop].lat]},properties:{"marker-size":"large","marker-color":mapService.markerColorFn(markerData,prop),"marker-symbol":"heart",projectId:markerData[prop]._id,summary:markerData[prop].storySummary,title:markerData[prop].title,mainImage:markerData[prop].mainImage,category:markerData[prop].category,mapImage:markerData[prop].mapImage,lat:markerData[prop].lat,lng:markerData[prop].lng,published:markerData[prop].created,leafletId:null,arrayIndexId:index}}).on("click",function(e){return $scope.$apply(function(){$scope.storyEvent=e.target._geojson.properties}),map.panTo(e.layer.getLatLng()),popupMenuToggle(e),$scope.projectMarker[prop]}),$scope.projectMarker.addTo(map),$scope.markerArray.push($scope.projectMarker),index++;return $scope.markerArray};new L.Point(30,-16);$scope.toggleGooglePlacesData=function(){$scope.googlePlacesLayer?map.removeLayer(googlePlacesMarkerLayer):map.addLayer(googlePlacesMarkerLayer)},map.on("click",function(e){$scope.menuOpen&&sidebar.close()}),$scope.getProjectMarkers=function(markerData){}},popupMenuToggle=function(e){$scope.menuOpen||popupIndex===e.target._leaflet_id?($scope.menuOpen||popupIndex!==e.target._leaflet_id)&&($scope.menuOpen&&popupIndex!==e.target._leaflet_id?(sidebar.open("details"),popupIndex=e.target._leaflet_id):$scope.menuOpen&&popupIndex===e.target._leaflet_id&&(sidebar.close(),popupIndex=0)):($scope.toggleOverlayFunction("menu-closed"),sidebar.open("details"),popupIndex=e.target._leaflet_id)}}]);
"use strict";angular.module("core").controller("ModalController",["$scope","Authentication","$modal","$location","$http",function($scope,Authentication,$modal,$location,$http){$scope.authentication=Authentication}]);
"use strict";angular.module("core").directive("featuredProjects",function(){return{restrict:"E",templateUrl:"/modules/core/client/directives/views/featured-projects.html"}});
"use strict";angular.module("core").directive("footerDirective",function(){return{restrict:"AE",priority:0,templateUrl:"/modules/core/client/directives/views/footer-directive.html"}});
"use strict";angular.module("core").directive("randomMapDirective",[function($scope){var staticMap=null,maps={originalMap:"poetsrock.55znsh8b",grayMap:"poetsrock.b06189bb",mainMap:"poetsrock.la999il2",topoMap:"poetsrock.la97f747",greenMap:"poetsrock.jdgpalp2",funkyMap:"poetsrock.23d30eb5"},randomMap=[maps.originalMap,maps.grayMap,maps.mainMap,maps.topoMap,maps.greenMap,maps.funkyMap],getRandomArbitrary=function(min,max){return Math.random()*(max-min)+min},randomLat=function(){var randomLngInt=Math.floor(getRandomArbitrary(111,113));if(111===randomLngInt)return"-111."+Math.floor(getRandomArbitrary(7840,9999));var randomDecimal=Math.floor(getRandomArbitrary(100,600));return"-112.0"+randomDecimal},randomLng=function(){return"40."+Math.floor(getRandomArbitrary(0,9999))},randomMapId=function(){return Math.floor(getRandomArbitrary(0,7))},randomZoom=function(){return Math.floor(getRandomArbitrary(10,18))};return{template:"<div></div>",restrict:"EA",link:function(scope,element,attrs){staticMap="http://api.tiles.mapbox.com/v4/"+randomMap[randomMapId()]+"/"+randomLat()+","+randomLng()+","+randomZoom()+"/1280x720.png?access_token=pk.eyJ1IjoicG9ldHNyb2NrIiwiYSI6Imc1b245cjAifQ.vwb579x58Ma-CcnfQNamiw"}}}]);
"use strict";angular.module("core").directive("mainMenu",function(){return{restrict:"E",templateUrl:"/modules/core/client/directives/views/main-menu.html",controller:function(){},link:function(){L.control.sidebar("sidebar",{closeButton:!0,position:"left"}).addTo(map)}}});
"use strict";angular.module("core").directive("mainPageOverlay",function(){return{restrict:"AE",priority:10,templateUrl:"/modules/core/client/directives/views/main-page-overlay.html"}});
"use strict";angular.module("core").directive("secondaryMenuDirective",function(){return{restrict:"E",templateUrl:"/modules/core/client/directives/views/secondary-menu-directive.html",controller:["AdminAuthService","$scope",function(AdminAuthService,$scope){$scope.isAdmin=AdminAuthService}],link:function(scope){scope.secondMenuOpened=!1,scope.toggleSecondMenu=!1}}});
"use strict";angular.module("core").directive("secondaryPageDirective",function(){return{restrict:"AE",priority:0,templateUrl:"/modules/core/client/directives/views/secondary-page.html"}});
"use strict";angular.module("core").directive("showErrors",["$timeout","$interpolate",function($timeout,$interpolate){var linkFn=function(scope,el,attrs,formCtrl){var inputEl,inputName,inputNgEl,options,showSuccess,toggleClasses,initCheck=!1,showValidationMessages=!1;if(options=scope.$eval(attrs.showErrors)||{},showSuccess=options.showSuccess||!1,inputEl=el[0].querySelector(".form-control[name]")||el[0].querySelector("[name]"),inputNgEl=angular.element(inputEl),inputName=$interpolate(inputNgEl.attr("name")||"")(scope),!inputName)throw"show-errors element has no child input elements with a 'name' attribute class";var reset=function(){return $timeout(function(){el.removeClass("has-error"),el.removeClass("has-success"),showValidationMessages=!1},0,!1)};scope.$watch(function(){return formCtrl[inputName]&&formCtrl[inputName].$invalid},function(invalid){return toggleClasses(invalid)}),scope.$on("show-errors-check-validity",function(event,name){return angular.isUndefined(name)||formCtrl.$name===name?(initCheck=!0,showValidationMessages=!0,toggleClasses(formCtrl[inputName].$invalid)):void 0}),scope.$on("show-errors-reset",function(event,name){return angular.isUndefined(name)||formCtrl.$name===name?reset():void 0}),toggleClasses=function(invalid){return el.toggleClass("has-error",showValidationMessages&&invalid),showSuccess?el.toggleClass("has-success",showValidationMessages&&!invalid):void 0}};return{restrict:"A",require:"^form",compile:function(elem,attrs){if(-1===attrs.showErrors.indexOf("skipFormGroupCheck")&&!elem.hasClass("form-group")&&!elem.hasClass("input-group"))throw"show-errors element does not have the 'form-group' or 'input-group' class";return linkFn}}}]);
"use strict";angular.module("core").directive("signInDirective",function(){return{restrict:"E",templateUrl:"/modules/core/client/directives/views/sign-in-directive.html"}});
"use strict";angular.module("core").directive("submitProjectDirective",function(){return{restrict:"E",templateUrl:"/modules/core/client/directives/views/submit-project-directive.html"}});
"use strict";angular.module("core").service("ApiKeys",["$http",function($http){this.getApiKeys=function(){return $http.get("/api/v1/keys")},this.getTractData=function(){return $http.get("api/v1/tractData")}}]);
"use strict";angular.module("core").factory("Authentication",[function(){var _this=this;return _this._data={user:window.user},_this._data}]);
"use strict";angular.module("core").service("CensusDataService",["$http","ApiKeys",function($http,ApiKeys){var censusData=null,censusYear=[2e3,2010,2011,2012,2013,2014],population="";this.callCensusApi=function(){ApiKeys.getApiKeys().success(function(data){censusData(data.censusKey)}).error(function(data,status){alert("Failed to load Mapbox API key. Status: "+status)}),censusData=function(censusKey){return $http.get("http://api.census.gov/data/"+censusYear[1]+"/sf1?get="+population+"&for=tract:*&in=state:49+county:035&key="+censusKey)}}}]);

"use strict";angular.module("core").service("RandomMapService",[function(){var staticMap=null,maps={mapbox:{originalMap:"poetsrock.j5o1g9on",grayMap:"poetsrock.b06189bb",mainMap:"poetsrock.la999il2",topoMap:"poetsrock.la97f747",greenMap:"poetsrock.jdgpalp2",comic:"poetsrock.23d30eb5",fancyYouMap:"poetsrock.m6b73kk7",pencilMeInMap:"poetsrock.m6b7f6mj"},thunderforest:{landscape:"http://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png"},stamen:{watercolor:"https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png",toner:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"}},url={mapbox:"http://api.tiles.mapbox.com/v4",thunderforest:"http://{s}.tile.thunderforest.com",stamen:"http://maps.stamen.com/m2i",ngs:""},randomMap=[["mapbox",maps.mapbox.originalMap],["mapbox",maps.mapbox.grayMap],["mapbox",maps.mapbox.mainMap],["mapbox",maps.mapbox.topoMap],["mapbox",maps.mapbox.greenMap],["mapbox",maps.mapbox.comic],["mapbox",maps.mapbox.fancyYouMap],["mapbox",maps.mapbox.pencilMeInMap],["stamen",maps.stamen.watercolor],["stamen",maps.stamen.toner],["thunderforest",maps.thunderforest.landscape]],getRandomArbitrary=function(min,max){return Math.random()*(max-min)+min},randomLat=function(){var randomLngInt=Math.floor(getRandomArbitrary(111,113));if(111===randomLngInt)return"-111."+Math.floor(getRandomArbitrary(7840,9999));var randomDecimal=Math.floor(getRandomArbitrary(100,600));return"-112.0"+randomDecimal},randomLng=function(){return"40."+Math.floor(getRandomArbitrary(0,9999))},randomZoom=function(){return Math.floor(getRandomArbitrary(9,16))};this.getRandomMap=function(){var randomNum=Math.floor(getRandomArbitrary(0,10)),mapVendor=randomMap[randomNum][0],randomMapId=randomMap[randomNum][1];return"mapbox"===mapVendor?staticMap={mapUrl:url.mapbox+"/"+randomMapId+"/"+randomLat()+","+randomLng()+","+randomZoom()+"/1280x720.png?access_token=pk.eyJ1IjoicG9ldHNyb2NrIiwiYSI6Imc1b245cjAifQ.vwb579x58Ma-CcnfQNamiw"}:"stamen"===mapVendor?staticMap={mapUrl:"http://maps.stamen.com/m2i/#watercolor/1280:720/14/40.8905/-112.0204"}:void console.log("Error!\nrandomNum: ",randomNum,"\nmapVendor",mapVendor,"\nrandomMapId: ",randomMapId)}}]);
"use strict";angular.module("core").factory("googlePlacesService",["$http",function($http){}]);

"use strict";angular.module("core").service("mapService",[function($scope){this.featuredProjects=function(markerData){var featureProjectsArray=[];for(var prop in markerData){var i=0;if(2>i&&markerData[prop].featured){var featuredProject={thumb:markerData[prop].thumbnail,projectId:markerData[prop]._id,shortTitle:markerData[prop].shortTitle};featureProjectsArray.push(featuredProject)}i++}},this.markerColorFn=function(markerData,prop){return"video"===markerData[prop].category?"#ff0011":"multimedia"===markerData[prop].category?"#ff0101":"essay"===markerData[prop].category?"#0015ff":"literature"===markerData[prop].category?"#15ff35":"interview"===markerData[prop].category?"brown":"map"===markerData[prop].category?"yellow":"audio"===markerData[prop].category?"#111111":"#00ff44"}}]);
"use strict";angular.module("core").service("MarkerDataService",["$http",function($http){this.getMarkerData=function(){return $http.get("/api/v1/markerData").success(function(projects){}).error(function(error){console.log("marker data error: \n",error)})}}]);
"use strict";angular.module("core").service("Menus",[function(){this.defaultRoles=["user","admin"],this.menus={};var shouldRender=function(user){if(~this.roles.indexOf("*"))return!0;if(!user)return!1;for(var userRoleIndex in user.roles)for(var roleIndex in this.roles)if(this.roles[roleIndex]===user.roles[userRoleIndex])return!0;return!1};this.validateMenuExistance=function(menuId){if(menuId&&menuId.length){if(this.menus[menuId])return!0;throw new Error("Menu does not exist")}throw new Error("MenuId was not provided")},this.getMenu=function(menuId){return this.validateMenuExistance(menuId),this.menus[menuId]},this.addMenu=function(menuId,options){return options=options||{},this.menus[menuId]={roles:options.roles||this.defaultRoles,items:options.items||[],shouldRender:shouldRender},this.menus[menuId]},this.removeMenu=function(menuId){this.validateMenuExistance(menuId),delete this.menus[menuId]},this.addMenuItem=function(menuId,options){if(options=options||{},this.validateMenuExistance(menuId),this.menus[menuId].items.push({title:options.title||"",state:options.state||"",type:options.type||"item","class":options["class"],roles:null===options.roles||"undefined"==typeof options.roles?this.defaultRoles:options.roles,position:options.position||0,items:[],shouldRender:shouldRender}),options.items)for(var i in options.items)this.addSubMenuItem(menuId,options.state,options.items[i]);return this.menus[menuId]},this.addSubMenuItem=function(menuId,parentItemState,options){options=options||{},this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].state===parentItemState&&this.menus[menuId].items[itemIndex].items.push({title:options.title||"",state:options.state||"",roles:null===options.roles||"undefined"==typeof options.roles?this.menus[menuId].items[itemIndex].roles:options.roles,position:options.position||0,shouldRender:shouldRender});return this.menus[menuId]},this.removeMenuItem=function(menuId,menuItemState){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].state===menuItemState&&this.menus[menuId].items.splice(itemIndex,1);return this.menus[menuId]},this.removeSubMenuItem=function(menuId,submenuItemState){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)for(var subitemIndex in this.menus[menuId].items[itemIndex].items)this.menus[menuId].items[itemIndex].items[subitemIndex].state===submenuItemState&&this.menus[menuId].items[itemIndex].items.splice(subitemIndex,1);return this.menus[menuId]},this.addMenu("topbar",{roles:["*"]})}]);
"use strict";angular.module("core").service("Socket",["Authentication","$state","$timeout",function(Authentication,$state,$timeout){this.connect=function(){Authentication.user&&(this.socket=io())},this.connect(),this.on=function(eventName,callback){this.socket&&this.socket.on(eventName,function(data){$timeout(function(){callback(data)})})},this.emit=function(eventName,data){this.socket&&this.socket.emit(eventName,data)},this.removeListener=function(eventName){this.socket&&this.socket.removeListener(eventName)}}]);
"use strict";angular.module("core").factory("tractDataService",["$scope","ApiKeys",function($scope,ApiKeys){var dataBoxStaticPopup=null,censusTractData=null;ApiKeys.getTractData().success(function(tractData){tractDataLayer(tractData)}).error(function(tractData){alert("Failed to load tractData. Status: "+status)});var tractDataLayer=function(tractData){censusTractData=L.geoJson(tractData,{style:style,onEachFeature:function(feature,layer){if(feature.properties){var popupString='<div class="popup">';for(var k in feature.properties){var v=feature.properties[k];popupString+=k+": "+v+"<br />"}popupString+="</div>",layer.bindPopup(popupString)}layer instanceof L.Point||(layer.on("mouseover",function(){layer.setStyle(hoverStyle)}),layer.on("mouseout",function(){layer.setStyle(style)}))}})};$scope.dataBoxStaticPopupFn=function(dataBoxStaticPopup){function empty(){info.innerHTML="<div><strong>Click a marker</strong></div>"}dataBoxStaticPopup.on("mouseover",function(e){e.layer.closePopup();var feature=e.layer.feature,content="<div><strong>"+feature.properties.title+"</strong><p>"+feature.properties.description+"</p></div>";info.innerHTML=content}),map.on("move",empty),empty()},$scope.toggleCensusData=function(){$scope.censusDataTractLayer?(map.addLayer(censusTractData),map.addLayer(dataBoxStaticPopup)):(map.removeLayer(censusTractData),map.removeLayer(dataBoxStaticPopup))}}]);
"use strict";angular.module("core").factory("_",[function(){return window._}]);
"use strict";angular.module("core").service("UtilsService",["$http","$window",function($http,$window){this.cssLayout=function(){function onInputFocus(ev){classie.add(ev.target.parentNode,"input-filled")}function onInputBlur(ev){""===ev.target.value.trim()&&classie.remove(ev.target.parentNode,"input-filled")}[].slice.call(document.querySelectorAll("input.input_field")).forEach(function(inputEl){""!==inputEl.value.trim()&&classie.add(inputEl.parentNode,"input-filled"),inputEl.addEventListener("focus",onInputFocus),inputEl.addEventListener("blur",onInputBlur)})}}]);
"use strict";angular.module("projects").config(["$stateProvider",function($stateProvider){$stateProvider.state("listProjects",{url:"/projects",templateUrl:"modules/projects/client/views/list-projects.client.view.html"}).state("createProject",{url:"/projects/create",templateUrl:"modules/projects/client/views/create-project.client.view.html",authenticate:!0}).state("viewProject",{url:"/projects/:projectId",templateUrl:"modules/projects/client/views/view-project.client.view.html"}).state("editProject",{url:"/projects/:projectId/edit",templateUrl:"modules/projects/client/views/edit-project.client.view.html"}).state("andrewShaw",{url:"/shaw",templateUrl:"modules/projects/client/views/view-project.client.shaw.html"}).state("westsideLeadershipInstitute",{url:"/westside-leadership-institute",templateUrl:"modules/projects/client/views/view-project.client.wli.html"})}]);
"use strict";angular.module("projects").controller("ProjectsController",["$scope","$stateParams","$location","Authentication","Projects","$http","$modal","$sce","ApiKeys","GeoCodeApi","$rootScope","AdminAuthService","$state","UtilsService","PublishingService",function($scope,$stateParams,$location,Authentication,Projects,$http,$modal,$sce,ApiKeys,GeoCodeApi,$rootScope,AdminAuthService,$state,UtilsService,PublishingService){$scope.Authentication=Authentication,$scope.isAdmin=AdminAuthService,$scope.logo="../../../modules/core/img/brand/mapping_150w.png";var width="800",height="250",markerUrl="url-http%3A%2F%2Fwww.mappingslc.org%2Fimages%2Fsite_img%2Flogo_marker_150px.png";$scope.mapImage="",$rootScope.signInBeforeProject=!1,$scope.street="547 South 300 East",$scope.city="Salt Lake City",$scope.state="UT",$scope.zip="84111",$scope.title="My Goodly Project",$scope.story="Here's my story... it starts with wisdom, loses that along the way and ends with sadness",$scope.init=function(){$scope.publishedProjects()};var publishUser=function(userId){};UtilsService.cssLayout();var publishProject=function(project){"published"===project.status&&(console.log("project.user._id: ",project.user._id),publishUser(project.user._id),project.previouslyPublished=!0)};$scope.trustAsHtml=$sce.trustAsHtml,$scope.toggleEdit=!1,$scope.toggleId=0,$scope.toggleEditFn=function(editNum){$scope.toggleEdit=!$scope.toggle,$scope.toggleId=editNum};var saveProject=null;$scope.updateLatLng=function(project){$http.get("/api/v1/keys").success(function(data){var mapboxKey=data.mapboxKey,mapboxSecret=data.mapboxSecret,hereKey=data.hereKey,hereSecret=data.hereSecret;GeoCodeApi.callGeoCodeApi(project,hereKey,hereSecret,saveProject).success(function(data){project.lat=data.Response.View[0].Result[0].Location.DisplayPosition.Latitude,project.lng=data.Response.View[0].Result[0].Location.DisplayPosition.Longitude,project.mapImage="http://api.tiles.mapbox.com/v4/"+mapboxKey+"/"+markerUrl+"("+project.lng+","+project.lat+")/"+project.lng+","+project.lat+",15/"+width+"x"+height+".png?access_token="+mapboxSecret,saveProject()}).error(function(data,status){})})},$scope.publishedProjects=function(){$http.get("/api/v1/projects/published").success(function(publishedProjects){$scope.publishedProjects=publishedProjects,console.log("$scope.publishedProjects:\n",$scope.publishedProjects),console.log("$scope.publishedProjects.title:\n",$scope.publishedProjects[0].title)}).error(function(data,status){})},$rootScope.previousState="",$rootScope.currentState="",$rootScope.$on("$stateChangeSuccess",function(ev,to,toParams,from){$rootScope.previousState=from.name,$rootScope.currentState=to.name}),$scope.goBack=function(){"listProjects"===$rootScope.previousState?$state.go($rootScope.previousState):$state.go("admin")},$scope.run=function($rootScope,$state,Authentication){$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){toState.authenticate&&!Authentication.isLoggedIn(),event.preventDefault()})},$scope.userLoggedin=function(){"/projects/create"===$location.path()&&$http.get("/api/v1/users/me").success(function(data){null===data&&($rootScope.signInBeforeProject=!0,$location.path("/signin"))})}();$scope.create=function(isValid){if($scope.error=null,!isValid)return $scope.$broadcast("show-errors-check-validity","projectForm"),!1;var project=new Projects({created:this.created,createdBy:this.createdBy,street:this.street,city:this.city,state:this.state,zip:this.zip,story:this.story,title:this.title});saveProject=function(){project.$save(function(response){$location.path("projects/"+response._id),$scope.street="",$scope.city="",$scope.state="",$scope.zip="",$scope.story="",$scope.title=""},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.updateLatLng(project)},$scope.remove=function(project){if(project){project.$remove();for(var i in $scope.projects)$scope.projects[i]===project&&$scope.projects.splice(i,1)}else $scope.project.$remove(function(){$location.path()==="/admin/edit-project/"+$scope.project._id?$location.path("admin/projects-queue"):$location.path("projects")})},$scope.update=function(){var project=$scope.project;publishProject(project),project.$update(function(){$location.path()==="/admin/edit-project/"+project._id||$location.path("projects/"+project._id)},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.find=function(){$scope.projects=Projects.query(),console.log("$scope.projects",$scope.projects)},$scope.findOne=function(){$scope.project=Projects.get({projectId:$stateParams.projectId});var vimeoId,soundCloudId;$http.get("/api/v1/keys").success(function(data){vimeoId=data.vimeoId,soundCloudId=data.soundCloudId}),soundCloudId&&($scope.soundCloudId="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/"+project.soundCloudId+"&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"),vimeoId&&($scope.vimeoId=""+project.vimeoId)},$scope.completed=function(){var formField;for(formField in $scope.createProject){if(null===$scope.createProject)return $scope.completed=!1;$scope.completed=!0}},$scope.editorOptions={language:"en",uiColor:"#02211D"},CKEDITOR.replaceClass="ck-crazy";var preventRunning=!1;$scope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){console.log("preventRunning: ",preventRunning),preventRunning||"/projects/client/create"===fromState.url&&"/projects/:projectId"!==toState.url&&(event.preventDefault(),$modal.open({animation:!0,templateUrl:"/modules/projects/client/directives/views/project-warning-modal.html",controller:["$scope","$modalInstance","$location",function($scope,$modalInstance,$location){$scope.stay=function(result){console.log("stay just a little bit longer, oh won't you stay"),$modalInstance.close(function(result){console.log("result: ",result)})},$scope.leave=function(){preventRunning=!0,$scope.stay(),$location.path(toState)}}],size:"lg"}))})}]);

"use strict";angular.module("projects").service("GeoCodeApi",["$http",function($http){this.callGeoCodeApi=function(project,key,secret,projectSaveCallback){return console.log("project:\n",project,"\nkey:\n",key,"\nsecret:\n",secret),project&&project.state&&project.city&&project.zip&&project.street&&key&&secret?$http.get("http://geocoder.cit.api.here.com/6.2/geocode.json?state="+project.state+"&city="+project.city+"&postalcode="+project.zip+"&street="+project.street+"&gen=8&app_id="+key+"&app_code="+secret).success(function(geoData){console.log("success:  modules/projects/client/services/geoCodeApi.client.service.js line 24"),project.lat=geoData.Response.View[0].Result[0].Location.DisplayPosition.Latitude,project.lng=geoData.Response.View[0].Result[0].Location.DisplayPosition.Longitude}).error(function(data,status){console.log("geocode error:\n",data,"status:\n",status)}):(projectSaveCallback(),void console.log("err, there's an error, yo."))}}]);
"use strict";angular.module("projects").factory("Projects",["$resource",function($resource){return $resource("api/v1/projects/:projectId",{projectId:"@_id"},{update:{method:"PUT"}},{create:{method:"POST"}},{read:{method:"GET"}})}]);
"use strict";angular.module("projects").service("PublishingService",["$http",function($http){this.getPublishedProjects=function(){console.log("publishing service"),$http.get("/api/v1/projects/published")}}]);
"use strict";angular.module("users.admin").run(["Menus",function(Menus){Menus.addSubMenuItem("topbar","admin",{title:"Manage Users",state:"admin.users"})}]);
"use strict";angular.module("users.admin.routes").config(["$stateProvider",function($stateProvider){$stateProvider.state("admin.users",{url:"/users",templateUrl:"modules/users/client/views/admin/list-users.client.view.html",controller:"UserListController"}).state("admin.user",{url:"/users/:userId",templateUrl:"modules/users/client/views/admin/view-user.client.view.html",controller:"UserController",resolve:{userResolve:["$stateParams","Admin",function($stateParams,Admin){return Admin.get({userId:$stateParams.userId})}]}}).state("admin.user-edit",{url:"/users/:userId/edit",templateUrl:"modules/users/client/views/admin/edit-user.client.view.html",controller:"UserController",resolve:{userResolve:["$stateParams","Admin",function($stateParams,Admin){return Admin.get({userId:$stateParams.userId})}]}})}]);
"use strict";angular.module("users").config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push(["$q","$location","Authentication",function($q,$location,Authentication){return{responseError:function(rejection){switch(rejection.status){case 401:Authentication.user=null,$location.path("signin");break;case 403:}return $q.reject(rejection)}}}])}]).config(["LightboxProvider",function(LightboxProvider){LightboxProvider.templateUrl="/modules/users/client/views/lightbox.html",LightboxProvider.calculateImageDimensionLimits=function(dimensions){return{maxWidth:dimensions.windowWidth>=768?dimensions.windowWidth-92:dimensions.windowWidth-52,maxHeight:1600}},LightboxProvider.calculateModalDimensions=function(dimensions){var width=Math.max(400,dimensions.imageDisplayWidth+32);return(width>=dimensions.windowWidth-20||dimensions.windowWidth<768)&&(width="auto"),{width:width,height:"auto"}}}]);
"use strict";angular.module("users").config(["$stateProvider",function($stateProvider){$stateProvider.state("settings",{"abstract":!0,url:"/settings",templateUrl:"modules/users/client/views/settings/settings.client.view.html",data:{roles:["user","admin"]}}).state("settings.profile",{url:"/profile",templateUrl:"modules/users/client/views/settings/edit-profile.client.view.html"}).state("settings.password",{url:"/password",templateUrl:"modules/users/client/views/settings/change-password.client.view.html"}).state("settings.accounts",{url:"/accounts",templateUrl:"modules/users/client/views/settings/manage-social-accounts.client.view.html"}).state("settings.favorites",{url:"/favorites",templateUrl:"modules/users/client/views/settings/favorites.client.view.html"}).state("settings.picture",{url:"/picture",templateUrl:"modules/users/client/views/settings/change-profile-picture.client.view.html"}).state("authentication",{"abstract":!0,url:"/authentication",templateUrl:"modules/users/client/views/authentication/authentication.client.view.html"}).state("authentication.signup",{url:"/signup",templateUrl:"modules/users/client/views/authentication/signup.client.view.html"}).state("authentication.signin",{url:"/signin",templateUrl:"modules/users/client/views/authentication/signin.client.view.html"}).state("password",{"abstract":!0,url:"/password",template:"<ui-view/>"}).state("password.forgot",{url:"/forgot",templateUrl:"modules/users/client/views/password/forgot-password.client.view.html"}).state("password.reset",{"abstract":!0,url:"/reset",template:"<ui-view/>"}).state("password.reset.invalid",{url:"/invalid",templateUrl:"modules/users/client/views/password/reset-password-invalid.client.view.html"}).state("password.reset.success",{url:"/success",templateUrl:"modules/users/client/views/password/reset-password-success.client.view.html"}).state("password.reset.form",{url:"/:token",templateUrl:"modules/users/client/views/password/reset-password.client.view.html"}).state("contributors",{url:"/contributors",templateUrl:"modules/users/client/views/contributors.client.view.html"})}]);
"use strict";angular.module("users").controller("AuthenticationController",["$scope","$state","$http","$location","$window","Authentication","PasswordValidator","$modal",function($scope,$state,$http,$location,$window,Authentication,PasswordValidator,$modal){$scope.authentication=Authentication,$scope.popoverMsg=PasswordValidator.getPopoverMsg(),$scope.error=$location.search().err,$scope.authentication.user&&$location.path("/"),$scope.signup=function(isValid){return $scope.error=null,isValid?void $http.post("/api/v1/auth/signup",$scope.credentials).success(function(response){$scope.authentication.user=response,$state.go($state.previous.state.name||"home",$state.previous.params)}).error(function(response){$scope.error=response.message}):($scope.$broadcast("show-errors-check-validity","userForm"),!1)},$scope.signin=function(isValid){return $scope.error=null,isValid?void $http.post("/api/v1/auth/signin",$scope.credentials).success(function(response){$scope.authentication.user=response,$state.go($state.previous.state.name||"home",$state.previous.params)}).error(function(response){$scope.error=response.message}):($scope.$broadcast("show-errors-check-validity","userForm"),!1)},$scope.callOauthProvider=function(url){$state.previous&&$state.previous.href&&(url+="?redirect_to="+encodeURIComponent($state.previous.href)),$window.location.href=url},$scope.goToSignUp=function($state){$state.go("signup")},$scope.modalOpenSignUp=function(){var isSwitched=!1;$modal.open({templateUrl:function(){return isSwitched?"modules/users/client/views/authentication/signin.client.view.html":(isSwitched=!1,"modules/users/client/views/authentication/signup.client.view.html")},size:"lg",backdropClass:"sign-in-modal-background",windowClass:"sign-in-modal-background",backdrop:!1,controller:["$scope",function($scope){}]}).then(function(){console.log("Success!!!!!")})}}]);
"use strict";angular.module("users").controller("ContributorController",["$scope","$animate","$location","Authentication","GetContributors","$stateParams","$http","$modal","$window","Lightbox","UtilsService",function($scope,$animate,$location,Authentication,GetContributors,$stateParams,$http,$modal,$window,Lightbox,UtilsService){$scope.contributors=null,$scope.images=[],$scope.contribData={},UtilsService.cssLayout(),$scope.openLightboxModal=function(index){Lightbox.openModal($scope.images,index)},$scope.init=function(){getContribData()};var getContribData=function(){GetContributors.contributors().success(function(contributorsData){return getImages(contributorsData),$scope.contributors=contributorsData,$scope.images}).error(function(errorData){console.log("errorData: ",errorData)})},getImages=function(contribData){for(var i=0;i<contribData.length;i++){var tempData={};tempData.url=contribData[i].profileImageURL,tempData.thumbUrl=contribData[i].profileImageThumbURL,tempData.caption=contribData[i].bio,$scope.images.push(tempData)}};$scope.changeView=function(view){$location.path(view)}}]);
"use strict";angular.module("users").controller("GalleryController",["$scope","$stateParams","$location","Authentication","$http","$modal",function($scope,$stateParams,$location,Authentication,$http,$modal){var preventRunning=!1;$scope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){preventRunning||"/projects/create"===fromState.url&&"/projects/:projectId"!==toState.url&&(event.preventDefault(),$modal.open({templateUrl:"/modules/projects/directives/views/modal.html",controller:["$scope","$modalInstance",function($scope,$modalInstance){$scope.closeMe=function(){$modalInstance.dismiss(function(reason){console.log(reason)})},$scope.leave=function(){preventRunning=!0,$scope.closeMe(),$location.path(toState)}}],size:"lg"}))})}]);
"use strict";angular.module("users").controller("PasswordController",["$scope","$stateParams","$http","$location","Authentication","PasswordValidator",function($scope,$stateParams,$http,$location,Authentication,PasswordValidator){$scope.authentication=Authentication,$scope.popoverMsg=PasswordValidator.getPopoverMsg(),$scope.authentication.user&&$location.path("/"),$scope.askForPasswordReset=function(isValid){return $scope.success=$scope.error=null,isValid?void $http.post("/api/v1/auth/forgot",$scope.credentials).success(function(response){$scope.credentials=null,$scope.success=response.message}).error(function(response){$scope.credentials=null,$scope.error=response.message}):($scope.$broadcast("show-errors-check-validity","forgotPasswordForm"),!1)},$scope.resetUserPassword=function(isValid){return $scope.success=$scope.error=null,isValid?void $http.post("/api/v1/auth/reset/"+$stateParams.token,$scope.passwordDetails).success(function(response){$scope.passwordDetails=null,Authentication.user=response,$location.path("/password/reset/success")}).error(function(response){$scope.error=response.message}):($scope.$broadcast("show-errors-check-validity","resetPasswordForm"),!1)}}]);
"use strict";angular.module("users").directive("passwordValidator",["PasswordValidator",function(PasswordValidator){return{require:"ngModel",link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.unshift(function(password){var result=PasswordValidator.getResult(password),strengthIdx=0,strengthMeter=[{color:"danger",progress:"20"},{color:"warning",progress:"40"},{color:"info",progress:"60"},{color:"primary",progress:"80"},{color:"success",progress:"100"}];strengthMeter.length;return result.errors.length<strengthMeter.length&&(strengthIdx=strengthMeter.length-result.errors.length-1),scope.strengthColor=strengthMeter[strengthIdx].color,scope.strengthProgress=strengthMeter[strengthIdx].progress,result.errors.length?(scope.popoverMsg=PasswordValidator.getPopoverMsg(),scope.passwordErrors=result.errors,void modelCtrl.$setValidity("strength",!1)):(scope.popoverMsg="",modelCtrl.$setValidity("strength",!0),password)})}}}]);
"use strict";angular.module("users").directive("passwordVerify",function(){return{require:"ngModel",scope:{passwordVerify:"="},link:function(scope,element,attrs,modelCtrl){scope.$watch(function(){var combined;return(scope.passwordVerify||modelCtrl.$viewValue)&&(combined=scope.passwordVerify+"_"+modelCtrl.$viewValue),combined},function(value){value&&modelCtrl.$parsers.unshift(function(viewValue){var origin=scope.passwordVerify;return origin!==viewValue?void modelCtrl.$setValidity("passwordVerify",!1):(modelCtrl.$setValidity("passwordVerify",!0),viewValue)})})}}});
"use strict";angular.module("users").directive("lowercase",function(){return{require:"ngModel",link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.push(function(input){return input?input.toLowerCase():""}),element.css("text-transform","lowercase")}}});
"use strict";angular.module("users").service("GetContributors",["$http",function($http){this.contributors=function(){return $http.get("/api/v1/contributors")}}]);
"use strict";angular.module("users").factory("AdminAuthService",["$window","Authentication",function($window,Authentication){var auth=Authentication;if(""!==auth.user){var isAdmin={user:$window.user.roles[0]};return console.log("isAdmin.user",isAdmin.user),isAdmin}return"notAdmin"}]);
"use strict";angular.module("users").factory("Authentication",["$window",function($window){var auth={user:$window.user};return auth}]);
"use strict";angular.module("users").factory("PasswordValidator",["$window",function($window){var owaspPasswordStrengthTest=$window.owaspPasswordStrengthTest;return{getResult:function(password){var result=owaspPasswordStrengthTest.test(password);return result},getPopoverMsg:function(){var popoverMsg="Please enter a passphrase or password with at least 8 characters, and which contains at least one number, one lowercase character, upppercase, and special characters.";return popoverMsg}}}]);
"use strict";angular.module("users").service("SubscribeService",[function($scope,$location,Projects,$stateParams){$scope.update=function(){var project=$scope.project;project.$update(function(){$location.path("projects/"+project._id)},function(errorResponse){$scope.error=errorResponse.data.message})},$scope.find=function(){$scope.projects=Projects.query()},$scope.findOne=function(){$scope.project=Projects.get({projectId:$stateParams.projectId})},$scope.completed=function(){var formField;for(formField in $scope.createProject){if(null===$scope.createProject)return $scope.completed=!1,$scope.completed;$scope.completed=!0}},$scope.create=function(){new Projects({created:this.created,createdBy:this.createdBy,street:this.street,city:this.city,state:this.state,zip:this.zip,story:this.story,title:this.title})}}]);
"use strict";angular.module("users").factory("UserData",["$resource",function($resource){return $resource("users/:userId",{userId:"@_id"},{update:{method:"PUT"}})}]);
"use strict";angular.module("users").factory("Users",["$resource",function($resource){return $resource("/api/v1/users",{},{update:{method:"PUT"}})}]),angular.module("users.admin").factory("Admin",["$resource",function($resource){return $resource("/api/v1/users/:userId",{userId:"@_id"},{update:{method:"PUT"}})}]);
"use strict";angular.module("core").factory("authInterceptor",["$q","$injector",function($q,$injector){return{responseError:function(rejection){if(!rejection.config.ignoreAuthModule)switch(rejection.status){case 401:$injector.get("$state").transitionTo("authentication.signin");break;case 403:$injector.get("$state").transitionTo("forbidden")}return $q.reject(rejection)}}}]);
"use strict";angular.module("users.admin").controller("UserListController",["$scope","$filter","Admin",function($scope,$filter,Admin){Admin.query(function(data){$scope.users=data,$scope.buildPager()}),$scope.buildPager=function(){$scope.pagedItems=[],$scope.itemsPerPage=15,$scope.currentPage=1,$scope.figureOutItemsToDisplay()},$scope.figureOutItemsToDisplay=function(){$scope.filteredItems=$filter("filter")($scope.users,{$:$scope.search}),$scope.filterLength=$scope.filteredItems.length;var begin=($scope.currentPage-1)*$scope.itemsPerPage,end=begin+$scope.itemsPerPage;$scope.pagedItems=$scope.filteredItems.slice(begin,end)},$scope.pageChanged=function(){$scope.figureOutItemsToDisplay()}}]);
"use strict";angular.module("users.admin").controller("UserController",["$scope","$state","Authentication","userResolve",function($scope,$state,Authentication,userResolve){$scope.authentication=Authentication,$scope.user=userResolve,$scope.remove=function(user){confirm("Are you sure you want to delete this user?")&&(user?(user.$remove(),$scope.users.splice($scope.users.indexOf(user),1)):$scope.user.$remove(function(){$state.go("admin.users")}))},$scope.update=function(isValid){if(!isValid)return $scope.$broadcast("show-errors-check-validity","userForm"),!1;var user=$scope.user;user.$update(function(){$state.go("admin.user",{userId:user._id})},function(errorResponse){$scope.error=errorResponse.data.message})}}]);
"use strict";angular.module("users.admin").controller("UserController",["$scope","$state","Authentication","$stateParams","Users","UserData",function($scope,$state,Authentication,$stateParams,Users,UserData){$scope.authentication=Authentication,$scope.find=function(){$scope.users=Users.query($scope.query)},$scope.findOne=function(){$scope.user=UserData.getUser({userId:$stateParams.userId}),console.log("$scope.users: ",$scope.users)},$scope.init=function(){$scope.find()}}]);
"use strict";angular.module("users").controller("ChangePasswordController",["$scope","$http","Authentication","PasswordValidator",function($scope,$http,Authentication,PasswordValidator){$scope.user=Authentication.user,$scope.popoverMsg=PasswordValidator.getPopoverMsg(),$scope.changeUserPassword=function(isValid){return $scope.success=$scope.error=null,isValid?void $http.post("/api/v1/users/password",$scope.passwordDetails).success(function(response){$scope.$broadcast("show-errors-reset","passwordForm"),$scope.success=!0,$scope.passwordDetails=null}).error(function(response){$scope.error=response.message}):($scope.$broadcast("show-errors-check-validity","passwordForm"),!1)}}]);
"use strict";angular.module("users").controller("ChangeProfilePictureController",["$scope","$timeout","$window","Authentication","FileUploader",function($scope,$timeout,$window,Authentication,FileUploader){$scope.user=Authentication.user,$scope.imageURL=$scope.user.profileImageURL,$scope.uploader=new FileUploader({url:"api/v1/users/picture"}),$scope.uploader.filters.push({name:"imageFilter",fn:function(item,options){var type="|"+item.type.slice(item.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(type)}}),$scope.uploader.onAfterAddingFile=function(fileItem){if($window.FileReader){var fileReader=new FileReader;fileReader.readAsDataURL(fileItem._file),fileReader.onload=function(fileReaderEvent){$timeout(function(){$scope.imageURL=fileReaderEvent.target.result},0)}}},$scope.uploader.onSuccessItem=function(fileItem,response,status,headers){$scope.success=!0,$scope.user=Authentication.user=response,$scope.cancelUpload()},$scope.uploader.onErrorItem=function(fileItem,response,status,headers){$scope.cancelUpload(),$scope.error=response.message},$scope.uploadProfilePicture=function(){$scope.success=$scope.error=null,$scope.uploader.uploadAll()},$scope.cancelUpload=function(){$scope.uploader.clearQueue(),$scope.imageURL=$scope.user.profileImageURL}}]);
"use strict";angular.module("users").controller("EditProfileController",["$scope","$http","$location","Users","Authentication",function($scope,$http,$location,Users,Authentication){$scope.user=Authentication.user,$scope.updateUserProfile=function(isValid){if($scope.success=$scope.error=null,!isValid)return $scope.$broadcast("show-errors-check-validity","userForm"),!1;var user=new Users($scope.user);user.$update(function(response){$scope.$broadcast("show-errors-reset","userForm"),$scope.success=!0,Authentication.user=response},function(response){$scope.error=response.data.message})}}]);
"use strict";angular.module("users").controller("SocialAccountsController",["$scope","$http","Authentication",function($scope,$http,Authentication){$scope.user=Authentication.user,$scope.hasConnectedAdditionalSocialAccounts=function(provider){for(var i in $scope.user.additionalProvidersData)return!0;return!1},$scope.isConnectedSocialAccount=function(provider){return $scope.user.provider===provider||$scope.user.additionalProvidersData&&$scope.user.additionalProvidersData[provider]},$scope.removeUserSocialAccount=function(provider){$scope.success=$scope.error=null,$http["delete"]("/api/v1/users/accounts",{params:{provider:provider}}).success(function(response){$scope.success=!0,$scope.user=Authentication.user=response}).error(function(response){$scope.error=response.message})}}]);
"use strict";angular.module("users").controller("SettingsController",["$scope","Authentication",function($scope,Authentication){$scope.user=Authentication.user}]);